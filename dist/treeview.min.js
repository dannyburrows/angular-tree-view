!function(){"use strict";function e(){return{restrict:"E",template:'<tree-root root="searchData"></tree-root>',scope:{treeData:"=",selected:"=",expandAll:"=?",collapseAll:"=?",treeSearch:"=?"},link:function(e,n){function r(){e.selected=-1,e.treeSearch&&e.treeSearch.length>2?(e.searchData=[],e.treeData.forEach(function(n){a(n,e.searchData)})):void 0!=e.treeSearch&&""!=e.treeSearch||(e.searchData=e.treeData)}function a(n,r){(n.label.toLowerCase().indexOf(e.treeSearch.toLowerCase())>-1||""==e.treeSearch)&&r.push({label:n.label,id:n.id,expanded:!0,root:!0}),n.children&&n.children.length>0&&n.children.forEach(function(e){a(e,r)})}function c(){e.treeData&&angular.isArray(e.treeData)&&e.treeData.forEach(function(e){e.root=!0,e.expanded=!1})}function t(n,r){e.selected=r,e.$broadcast("branch_selected_highlight",{id:r})}function i(){e.treeData.forEach(function(e){h(e,!0)})}function l(){e.treeData.forEach(function(e){h(e,!1)})}function h(e,n){e.expanded=n,e.viewable=n,e.children&&angular.isArray(e.children)&&e.children.forEach(function(e){h(e,n)})}e.selected=-1,e.expandAll=i,e.collapseAll=l,angular.copy(e.treeData,e.searchData),c(),e.$on("branch_selected",t),e.$watch("treeSearch",r)}}}function n(){return{restrict:"E",template:'<div class="tree-view"><tree-branch ng-repeat="branch in root" branch="branch"></tree-branch></div>',replace:"true",scope:{root:"="}}}function r(e){return{restrict:"E",template:'<div style="cursor: pointer;" ng-click="toggle(branch);$event.stopPropagation()" ng-show="branch.viewable || branch.root"><div ng-class="{\'tree-view-selected\': branch.selected}"><span ng-class="{\'glyphicon glyphicon-plus\': !branch.expanded && (branch.children && branch.children.length > 0), \'glyphicon glyphicon-minus\': branch.expanded && (branch.children != null && branch.children.length > 0), \'glyphicon glyphicon-file\': (branch.children == null || branch.children.length == 0)}"></span> {{branch.label}}</div></div>',replace:!0,scope:{branch:"="},link:function(n,r,a){function c(){n.branch&&n.branch.children&&angular.isArray(n.branch.children)&&(r.append('<tree-root root="branch.children"></tree-view>'),e(r.contents())(n))}function t(e,r){n.branch.selected=r.id==n.last_selected}function i(e){e&&(e.viewable=!1,e.children&&angular.isArray(e.children)&&(e.expanded=!1,e.children.forEach(function(e){i(e)})))}function l(e){n.last_selected=e.id,n.$emit("branch_selected",e.id),null!==e.expanded&&(e.expanded=!e.expanded,e.children&&angular.isArray(e.children)&&e.children.forEach(function(n){n.viewable=e.expanded,n.viewable||(h(n,!1),n.expanded=!1)}))}function h(e,n){return!e.children||!angular.isArray(e.children)||e.children.length<=0?!1:e.children.forEach(function(e){return e.expanded=n,e.viewable=n,h(e,n)})}n.toggle=l,n.last_selected=-1,i(n.branch),c(),n.$on("branch_selected_highlight",t)}}}r.$inject=["$compile"],angular.module("monsciergetreeview",[]),angular.module("monsciergetreeview").directive("treeView",e).directive("treeRoot",n).directive("treeBranch",r)}();